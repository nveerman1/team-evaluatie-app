# =============================================================================
# Fail2ban Filter: nginx-tea-auth
# =============================================================================
#
# INSTALLATION:
# Copy to /etc/fail2ban/filter.d/nginx-tea-auth.conf on the VPS
#
# Detects authentication failures (401, 403) on auth endpoints
#
# =============================================================================

[Definition]
failregex = ^<HOST> .* "(GET|POST|PUT|DELETE|PATCH) /api/v1/auth/.* HTTP.*" (401|403) .*$
            ^<HOST> .* "(GET|POST) /api/v1/(login|register|token).* HTTP.*" (401|403) .*$

ignoreregex =

[Init]
datepattern = {^LN-BEG}%%Y/%%m/%%d %%H:%%M:%%S
