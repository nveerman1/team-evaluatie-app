# =============================================================================
# Fail2ban Filter: nginx-tea-exploits
# =============================================================================
#
# INSTALLATION:
# Copy to /etc/fail2ban/filter.d/nginx-tea-exploits.conf on the VPS
#
# Detects suspicious patterns indicating exploit attempts:
# - WordPress login attempts (wp-login.php, wp-admin)
# - Environment file probing (.env, .git)
# - CGI-bin exploits
# - SQL injection patterns
# - Path traversal attempts (../)
# - PHP file execution attempts
#
# =============================================================================

[Definition]
failregex = ^<HOST> .* "(GET|POST|HEAD) .*(wp-login\.php|wp-admin|xmlrpc\.php).*$
            ^<HOST> .* "(GET|POST|HEAD) .*(/\.env|/\.git|/config\.php|/phpinfo\.php).*$
            ^<HOST> .* "(GET|POST|HEAD) .*/cgi-bin/.*$
            ^<HOST> .* "(GET|POST|HEAD) .*(union.*select|concat.*char|waitfor.*delay).*$
            ^<HOST> .* "(GET|POST|HEAD) .*(\.\./).*$
            ^<HOST> .* "(GET|POST|HEAD) .*(\.php\?|shell\.php|cmd\.php|backdoor\.php).*$
            ^<HOST> .* "(GET|POST|HEAD) .*(eval\(|base64_decode|system\(|exec\().*$

ignoreregex =

[Init]
datepattern = {^LN-BEG}%%Y/%%m/%%d %%H:%%M:%%S
